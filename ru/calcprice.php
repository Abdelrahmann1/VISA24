<?php

function getPrice($citizenship, $visaType) {
    if ($citizenship =="Please select the citizenship" || !$visaType) {
        return null;
    }
    // echo "<script>alert(${citizenship})</script>";
    // Define visa prices based on citizenship
//  $visaPrices = [ "Algeria  (الجزائر)" => ["1" => 59, "3" => 360], "Angola" => ["1" => 59, "3" => 360], "Benin (Bénin)" => ["1" => 59, "3" => 360], "Botswana" => ["1" => 59, "3" => 360], "Burkina Faso" => ["1" => 59, "3" => 360], "Burundi (Uburundi)" => ["1" => 59, "3" => 360], "Cabo Verde" => ["1" => 59, "3" => 360], "Cameroon (Cameroun)" => ["1" => 59, "3" => 360], "Central African Republic" => ["1" => 59, "3" => 360], "Chad" => ["1" => 59, "3" => 360], "Comoros" => ["1" => 59, "3" => 360], "Republic of the Congo" => ["1" => 59, "3" => 360], "Democratic Republic of the Congo" => ["1" => 59, "3" => 360], "Côte d’Ivoire" => ["1" => 59, "3" => 360], "Djibouti" => ["1" => 59, "3" => 360], "Egypt (‫مصر‬‎)" => ["1" => 59, "3" => 360], "Equatorial Guinea" => ["1" => 59, "3" => 360], "Eritrea" => ["1" => 59, "3" => 360], "Eswatini" => ["1" => 59, "3" => 360], "Ethiopia" => ["1" => 59, "3" => 360], "Gabon" => ["1" => 59, "3" => 360], "Gambia" => ["1" => 59, "3" => 360], "Ghana" => ["1" => 59, "3" => 360], "Guinea" => ["1" => 59, "3" => 360], "Guinea-Bissau" => ["1" => 59, "3" => 360], "Kenya" => ["1" => 59, "3" => 360], "Lesotho" => ["1" => 59, "3" => 360], "Liberia" => ["1" => 59, "3" => 360], "Libya" => ["1" => 59, "3" => 360], "Madagascar" => ["1" => 59, "3" => 360], "Malawi" => ["1" => 59, "3" => 360], "Mali" => ["1" => 59, "3" => 360], "Mauritania" => ["1" => 59, "3" => 360], "Mauritius" => ["1" => 59, "3" => 360], "Morocco" => ["1" => 59, "3" => 360], "Mozambique" => ["1" => 59, "3" => 360], "Namibia" => ["1" => 59, "3" => 360], "Niger" => ["1" => 59, "3" => 360], "Nigeria" => ["1" => 59, "3" => 360], "Rwanda" => ["1" => 59, "3" => 360], "São Tomé and Príncipe" => ["1" => 59, "3" => 360], "Senegal" => ["1" => 59, "3" => 360], "Seychelles" => ["1" => 59, "3" => 360], "Sierra Leone" => ["1" => 59, "3" => 360], "Somalia (Soomaaliya)" => ["1" => 59, "3" => 360], "South Africa" => ["1" => 59, "3" => 360], "South Sudan (‫جنوب السودان‬‎)" => ["1" => 59, "3" => 360], "Sudan (‫السودان‬‎)" => ["1" => 59, "3" => 360], "Tanzania" => ["1" => 59, "3" => 360], "Togo" => ["1" => 59, "3" => 360], "Tunisia (‫تونس‬‎)" => ["1" => 59, "3" => 360], "Uganda" => ["1" => 59, "3" => 360], "Zambia" => ["1" => 59, "3" => 360], "Zimbabwe" => ["1" => 59, "3" => 360], "Pakistan" => ["1" => 59, "3" => 360], "India" => ["1" => 59, "3" => 360], "Bangladesh (বাংলাদেশ)" => ["1" => 59, "3" => 360], "Nepal" => ["1" => 59, "3" => 360], "Sri Lanka (ශ්‍රී ලංකාව)" => ["1" => 59, "3" => 360], "Syria" => ["1" => 59, "3" => 360], "Lebanon" => ["1" => 59, "3" => 360], "Afghanistan" => ["1" => 890, "3" => 1300], "Yemen (‫اليمن‬‎)" => ["1" => 59, "3" => 360], "Aruba" => ["1" => 59, "3" => 360], "Anguilla" => ["1" => 59, "3" => 360], "Åland Islands (Åland)" => ["1" => 59, "3" => 360], "Albania (Shqipëri)" => ["1" => 59, "3" => 360], "Andorra" => ["1" => 59, "3" => 360], "United Arab Emirates (‫الإمارات العربية المتحدة‬‎)" => ["1" => 59, "3" => 360], "Argentina" => ["1" => 59, "3" => 360], "Armenia (Հայաստան)" => ["1" => 59, "3" => 360], "American Samoa" => ["1" => 59, "3" => 360], "Antarctica" => ["1" => 59, "3" => 360], "French Southern Territories" => ["1" => 59, "3" => 360], "Antigua and Barbuda" => ["1" => 59, "3" => 360], "Australia" => ["1" => 59, "3" => 360], "Austria (Österreich)" => ["1" => 59, "3" => 360], "Azerbaijan (Azərbaycan)" => ["1" => 59, "3" => 360], "Belgium (België)" => ["1" => 59, "3" => 360], "Bonaire, Sint Eustatius and Saba" => ["1" => 59, "3" => 360], "Bulgaria (България)" => ["1" => 59, "3" => 360], "Bahrain" => ["1" => 59, "3" => 360], "Bahamas" => ["1" => 59, "3" => 360], "Bosnia and Herzegovina" => ["1" => 59, "3" => 360], "Saint Barthélemy" => ["1" => 59, "3" => 360], "Belarus (Беларусь)" => ["1" => 59, "3" => 360], "Belize" => ["1" => 59, "3" => 360], "Bermuda" => ["1" => 59, "3" => 360], "Bolivia, Plurinational State of" => ["1" => 59, "3" => 360], "Brazil (Brasil)" => ["1" => 59, "3" => 360], "Barbados" => ["1" => 59, "3" => 360], "Brunei Darussalam" => ["1" => 59, "3" => 360], "Bhutan (འབྲུག)" => ["1" => 59, "3" => 360], "Bouvet Island (Bouvetøya)" => ["1" => 59, "3" => 360], "Canada" => ["1" => 59, "3" => 360], "Cocos (Keeling) Islands" => ["1" => 59, "3" => 360], "Switzerland (Schweiz)" => ["1" => 59, "3" => 360], "Chile" => ["1" => 59, "3" => 360], "China" => ["1" => 59, "3" => 360], "Congo, The Democratic Republic of the" => ["1" => 59, "3" => 360], "Congo" => ["1" => 59, "3" => 360], "Cook Islands" => ["1" => 59, "3" => 360], "Colombia" => ["1" => 59, "3" => 360], "Costa Rica" => ["1" => 59, "3" => 360], "Cuba" => ["1" => 59, "3" => 360], "Curaçao" => ["1" => 59, "3" => 360], "Christmas Island" => ["1" => 59, "3" => 360], "Cayman Islands" => ["1" => 59, "3" => 360], "Cyprus" => ["1" => 59, "3" => 360], "Czechia" => ["1" => 59, "3" => 360], "Germany" => ["1" => 54449, "3" => 360], "Dominica" => ["1" => 59, "3" => 360], "Denmark" => ["1" => 59, "3" => 360], "Dominican Republic" => ["1" => 59, "3" => 360], "Ecuador" => ["1" => 59, "3" => 360], "Western Sahara (‫الصحراء الغربية‬‎)" => ["1" => 59, "3" => 360], "Spain (España)" => ["1" => 59, "3" => 360], "Estonia" => ["1" => 59, "3" => 360], "Finland" => ["1" => 59, "3" => 360], "Fiji" => ["1" => 59, "3" => 360], "Falkland Islands (Malvinas)" => ["1" => 59, "3" => 360], "France" => ["1" => 59, "3" => 360], "Faroe Islands" => ["1" => 59, "3" => 360], "Micronesia, Federated States of" => ["1" => 59, "3" => 360], "United Kingdom" => ["1" => 59, "3" => 360], "Georgia" => ["1" => 59, "3" => 360], "Guernsey" => ["1" => 59, "3" => 360], "Gibraltar" => ["1" => 59, "3" => 360], "Guadeloupe" => ["1" => 59, "3" => 360], "Greece" => ["1" => 59, "3" => 360], "Grenada" => ["1" => 59, "3" => 360], "Greenland" => ["1" => 59, "3" => 360], "Guatemala" => ["1" => 59, "3" => 360], "French Guiana" => ["1" => 59, "3" => 360], "Guam" => ["1" => 59, "3" => 360], "Guyana" => ["1" => 59, "3" => 360], "Hong Kong" => ["1" => 59, "3" => 360], "Heard Island and McDonald Islands" => ["1" => 59, "3" => 360], "Honduras" => ["1" => 59, "3" => 360], "Croatia" => ["1" => 59, "3" => 360], "Haiti" => ["1" => 59, "3" => 360], "Hungary" => ["1" => 59, "3" => 360], "Indonesia" => ["1" => 59, "3" => 360], "Isle of Man" => ["1" => 59, "3" => 360], "British Indian Ocean Territory" => ["1" => 59, "3" => 360], "Ireland" => ["1" => 59, "3" => 360], "Iran, Islamic Republic of" => ["1" => 59, "3" => 360], "Iraq" => ["1" => 59, "3" => 360], "Iceland" => ["1" => 59, "3" => 360], "Israel" => ["1" => 59, "3" => 360], "Italy" => ["1" => 59, "3" => 360], "Jamaica" => ["1" => 59, "3" => 360], "Jersey" => ["1" => 59, "3" => 360], "Jordan" => ["1" => 59, "3" => 360], "Japan" => ["1" => 59, "3" => 360], "Kazakhstan" => ["1" => 59, "3" => 360], "Kyrgyzstan" => ["1" => 59, "3" => 360], "Cambodia (កម្ពុជា)" => ["1" => 59, "3" => 360], "Kiribati" => ["1" => 59, "3" => 360], "Saint Kitts and Nevis" => ["1" => 59, "3" => 360], "Korea, Republic of" => ["1" => 59, "3" => 360], "Kuwait" => ["1" => 59, "3" => 360], "Lao People's Democratic Republic" => ["1" => 59, "3" => 360], "Saint Lucia" => ["1" => 59, "3" => 360], "Liechtenstein" => ["1" => 59, "3" => 360], "Lithuania" => ["1" => 59, "3" => 360], "Luxembourg" => ["1" => 59, "3" => 360], "Latvia" => ["1" => 59, "3" => 360], "Macao" => ["1" => 59, "3" => 360], "Saint Martin (French part)" => ["1" => 59, "3" => 360], "Monaco" => ["1" => 59, "3" => 360], "Moldova, Republic of" => ["1" => 59, "3" => 360], "Maldives" => ["1" => 59, "3" => 360], "Mexico" => ["1" => 59, "3" => 360], "Marshall Islands" => ["1" => 59, "3" => 360], "North Macedonia" => ["1" => 59, "3" => 360], "Malta" => ["1" => 59, "3" => 360], "Myanmar" => ["1" => 59, "3" => 360], "Montenegro" => ["1" => 59, "3" => 360], "Mongolia" => ["1" => 59, "3" => 360], "Northern Mariana Islands" => ["1" => 59, "3" => 360], "Montserrat" => ["1" => 59, "3" => 360], "Martinique" => ["1" => 59, "3" => 360], "Malaysia" => ["1" => 59, "3" => 360], "Mayotte" => ["1" => 59, "3" => 360], "New Caledonia" => ["1" => 59, "3" => 360], "Norfolk Island" => ["1" => 59, "3" => 360], "Nicaragua" => ["1" => 59, "3" => 360], "Niue" => ["1" => 59, "3" => 360], "Netherlands" => ["1" => 59, "3" => 360], "Norway" => ["1" => 59, "3" => 360], "Nauru" => ["1" => 59, "3" => 360], "New Zealand" => ["1" => 59, "3" => 360], "Oman" => ["1" => 59, "3" => 360], "Panama" => ["1" => 59, "3" => 360], "Pitcairn" => ["1" => 59, "3" => 360], "Peru" => ["1" => 59, "3" => 360], "Philippines" => ["1" => 59, "3" => 360], "Palau" => ["1" => 59, "3" => 360], "Papua New Guinea" => ["1" => 59, "3" => 360], "Poland" => ["1" => 59, "3" => 360], "Puerto Rico" => ["1" => 59, "3" => 360], "South Korea (대한민국)" => ["1" => 59, "3" => 360], "Portugal" => ["1" => 59, "3" => 360], "Paraguay" => ["1" => 59, "3" => 360], "Palestine, State of" => ["1" => 59, "3" => 360], "French Polynesia" => ["1" => 59, "3" => 360], "Qatar" => ["1" => 59, "3" => 360], "Réunion" => ["1" => 59, "3" => 360], "Romania" => ["1" => 59, "3" => 360], "Russian Federation" => ["1" => 59, "3" => 360], "Saudi Arabia" => ["1" => 59, "3" => 360], "Singapore" => ["1" => 59, "3" => 360], "South Georgia & South Sandwich Islands" => ["1" => 59, "3" => 360], "Saint Helena, Ascension and Tristan da Cunha" => ["1" => 59, "3" => 360], "Svalbard and Jan Mayen (Svalbard og Jan Mayen)" => ["1" => 59, "3" => 360], "Solomon Islands" => ["1" => 59, "3" => 360], "El Salvador" => ["1" => 59, "3" => 360], "San Marino" => ["1" => 59, "3" => 360], "Saint Pierre and Miquelon" => ["1" => 59, "3" => 360], "Serbia" => ["1" => 59, "3" => 360], "Sao Tome and Principe" => ["1" => 59, "3" => 360], "Suriname" => ["1" => 59, "3" => 360], "Slovakia" => ["1" => 59, "3" => 360], "Slovenia (Slovenija)" => ["1" => 59, "3" => 360], "Sweden (Sverige)" => ["1" => 59, "3" => 360], "Sint Maarten (Dutch part)" => ["1" => 59, "3" => 360], "Syria (‫سوريا‬‎)" => ["1" => 59, "3" => 360], "Turks and Caicos Islands" => ["1" => 59, "3" => 360], "Thailand (ไทย)" => ["1" => 59, "3" => 360], "Tajikistan" => ["1" => 59, "3" => 360], "Tokelau" => ["1" => 59, "3" => 360], "Turkmenistan" => ["1" => 59, "3" => 360], "Timor-Leste" => ["1" => 59, "3" => 360], "Tonga" => ["1" => 59, "3" => 360], "Trinidad and Tobago" => ["1" => 59, "3" => 360], "Turkey (Türkiye)" => ["1" => 59, "3" => 360], "Tuvalu" => ["1" => 59, "3" => 360], "Taiwan (台灣)" => ["1" => 59, "3" => 360], "Tanzania, United Republic of" => ["1" => 59, "3" => 360], "Ukraine" => ["1" => 59, "3" => 360], "U.S. Minor Outlying Islands" => ["1" => 59, "3" => 360], "Uruguay" => ["1" => 59, "3" => 360], "United States" => ["1" => 59, "3" => 360], "Uzbekistan (Oʻzbekiston)" => ["1" => 59, "3" => 360], "Vatican City (Città del Vaticano)" => ["1" => 59, "3" => 360], "Saint Vincent and the Grenadines" => ["1" => 59, "3" => 360], "Venezuela, Bolivarian Republic of" => ["1" => 59, "3" => 360], "Virgin Islands, British" => ["1" => 59, "3" => 360], "U.S. Virgin Islands" => ["1" => 59, "3" => 360], "Vietnam (Việt Nam)" => ["1" => 59, "3" => 360], "Vanuatu" => ["1" => 59, "3" => 360], "Wallis and Futuna" => ["1" => 59, "3" => 360], "Samoa" => ["1" => 59, "3" => 360] ];

$defaultPrice = ["1" => 59, "3" => 360];

// Exceptions
$specialPrices = [
    "Afghanistan (‫افغانستان‬‎)" => ["1" => 890, "3" => 1300]
];
    // return isset($visaPrices[$citizenship][$visaType]) ? $visaPrices[$citizenship][$visaType] : null;
  
        
        return $specialPrices[$citizenship][$visaType] ?? $defaultPrice[$visaType] ?? null;
    
}

if ($_SERVER["REQUEST_METHOD"] === "POST") {
    $data = json_decode(file_get_contents("php://input"), true);

    if (!$data || !isset($data["visitors"]) || !isset($data["currency"])) {
        echo json_encode(["error" => "Invalid request"]);
        exit;
    }

    $totalAmount = 0;
    foreach ($data["visitors"] as $visitor) {
        if (empty($visitor["citizenship"]) || empty($visitor["visaType"])) {
            continue;
        }

        $price = getPrice($visitor["citizenship"], $visitor["visaType"]);
        if (is_numeric($price)) {
            $totalAmount += $price;
        }
    }

    echo json_encode([
        "totalAmount" => $totalAmount,
        "currency" => htmlspecialchars($data["currency"])
    ]);
}
?>